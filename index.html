<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Waterfall.js</title>
    <link rel="stylesheet" href="waterfall.css">
</head>
<body>
    <section>
        <header>
            <p class="signature">Made by <a href="http://github.com/raphamorim"><span>@raphamorim</span></a></p>
            <h1>Waterfall.js</h1>
            <h2>Pinterest Grid</h2>
            <h3>Status: Unstable</h3>
        </header>
    </section>
    <section>
        <div class="waterfall">
            <div class="item">1</div>
            <div class="item">2</div>
            <div class="item">3</div>
            <div class="item">4</div>
            <div class="item">5</div>
            <div class="item">6</div>
            <div class="item">7</div>
            <div class="item">8</div>
            <div class="item">9</div>
            <div class="item">10</div>
            <div class="item">11</div>
            <div class="item">12</div>
            <div class="item">13</div>
            <div class="item">14</div>
            <div class="item">15</div>
            <div class="item">16</div>
            <div class="item">17</div>
        </div>
    </section>
    <section>
        <!-- Get Started  -->
    </section>
    <script src="waterfall.js"></script>
    <script>
        //waterfall();
        var items = [].slice.call(document.querySelectorAll('.item'));
        var container = document.querySelector('.waterfall');
        container.style.position = 'relative';
        items.forEach(function(item){
            item.style.position = 'absolute';
        });

        function px(n){ return n + 'px';}
        function max(l){ return Math.max.apply(Math, l);}
        function sum(a, b){ return a + b;}

        function y(el){ return parseFloat(el.style.top) || 0; }
        function height(el){ return el.clientHeight; }
        function width(el){ return el.clientWidth; }

        function column(columns, colIndex){
          return function(item, i){
            return i % columns == colIndex;
          }
        }

        var columns = [0, 1, 2].map(function(i){
          return items.filter(column(3, i));
        });

        var totalHeight = max(columns.map(function(column){
          return column.map(height).reduce(sum);
        }));

        function setLeft(item, i){
          item.style.left = px(width(item) * (i % 3));
        }

        function setTop(item, i, items){
          if(i > 0){
            var prev =  items[i - 1],
                top =  y(prev) + height(prev);
            item.style.top = px(top);
          }
        }

        container.style.height = px(totalHeight);
        columns.forEach(function(column){
          column.forEach(setTop);
        });
        items.forEach(setLeft);
    </script>
</body>
</html>
